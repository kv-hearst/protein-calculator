<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protein Calculator</title>
    <link rel="stylesheet" href="styles.css">

<style>
    body {
        font-family: Effra, sans-serif;
        margin: 0 auto;
    }
    .main-container {
        max-width: 400px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .head {
        line-height: 1.2;
    }
    .calculator-container {
        width: 250px;
        height: 200px;
        background-color: #f0f0f0;
        border-radius: 10px;
        display: flex;
        justify-content: center;
        box-shadow: inset 0 0 0 2px #333;
    }
    .input {
        display: flex;
        flex-direction: column;
        margin-top: 30px; 
        align-items: center;   
    }
    .input p {
        margin: 0;
        font-size: 16px;
    }
    input[type="number"] {
        padding: 10px;
        font-size: 16px;
        border: 2px solid #333;
        border-radius: 5px;
        margin-bottom: 10px;
        width: 100px;
        text-align: center;
    }
    #calculate {
        display: flex;
        flex-direction: column;
        width: 100%;
        padding: 10px;
        font-size: 14px;
        background-color: #965673;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-align: center;
        margin-top: 20px;
    }
    .results-container {
        margin-top: 20px;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
        max-height: 0;
        font-size: 14px;
        background-color: #f5f5f5;
        padding: 20px;
        border-radius: 5px;
        display: none;
        /* height: 150px; */
    }
    #results {
        font-weight: bold;
        margin-bottom: 10px;
        font-size: 20px;
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
       
    }
    .footer {
        text-align: left;
        font-size: 11px;
        line-height: 0.5;
        width: 100%;
        margin-top: 20px;
    }
    .toggle-container.kg .toggle-background {
            transform: translateX(calc(100% - 8px));
        }
        .toggle-container {
            width: 100px;
        }
        .toggle-option {
            flex: 1;
            text-align: center;
        }
        .toggle-option {
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            z-index: 1;
            transition: color 0.3s ease;
            border: none;
            background: none;
            color: #333;
            border-radius: 50px;
            user-select: none;
        }

        .toggle-container.lbs .toggle-option.lbs,
        .toggle-container.kg .toggle-option.kg {
            color: white;
            background-color: #965673;
        }

        .toggle-option:hover {
            opacity: 0.8;
        }

        .toggle-option:active {
            transform: scale(0.98);
        }
        .toggle-container {
            background: white;
            border-radius: 50px;
            padding: 8px;
            display: inline-flex;
            position: relative;
        }
        #active {
            background-color: #FFA84E;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
        }
        #peri {
            background-color: #F85769;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        #food-combinations {
            margin-top: 15px;
            flex-wrap: wrap;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
        }
    
</style>
</head>
<body>
    
    <div class="main-container">
        <div class="head">
            <h2>How much protein do you need?</h2>
        </div>
        <div class="calculator-container">
            <div class="input">
                <input type="number" id="weightInput" placeholder="0"/>
                <p>Your weight in pounds</p>
            </div>
        </div>
        <button id="calculate">Calculate</button>
        <div class="results-container">
            <div id="results">grams per day</div>
            <div id="food-combinations"></div>
            <p id="description">The Recommended Dietary Allowance (RDA) for protein in adults is 0.36 grams per pound of body weight. People who exercise regularly or are peri/menopausal have higher protein needs.</p>
            
            <div class="button-container">
                <button id="active">Active</button>
                <button id="peri">Menopausal</button>
            </div>
        </div>
        <div class="footer">
            <p>Source: <a href="https://fdc.nal.usda.gov/" target="_blank">USDA National Nutrient Database</a></p>
            <p>Interactive by Katrina Ventura/Get the Facts Data Team</p>

    </div>
<!-- <script>
    let weightInput = document.getElementById('weightInput');
    let calculateButton = document.getElementById('calculate');
    let results = document.getElementById('results');
    let description = document.getElementById('description');
    let activeButton = document.getElementById('active');
    let periButton = document.getElementById('peri');
    let isKg = false;
    let resultsContainer = document.querySelector('.results-container');
    let foodCombinations = document.getElementById('food-combinations');

    const foods = [
    { name: '3 oz tuna, salmon, haddock, or trout', protein: 21, id: 'fish', image: 'assets/salmon.png' },
    { name: '3 oz cooked turkey or chicken', protein: 19, id: 'poultry', image: 'assets/chicken.png' },
    { name: '6 oz plain Greek yogurt', protein: 17, id: 'yogurt', image: 'assets/yogurt.png' },
    { name: '½ cup cottage cheese', protein: 14, id: 'cottage', image: 'assets/cheese.png' },
    { name: '½ cup cooked beans', protein: 8, id: 'beans', image: 'assets/beans.png' },
    { name: '1 cup of milk', protein: 8, id: 'milk', image: 'assets/milk.png' },
    { name: '1 cup cooked pasta', protein: 8, id: 'pasta', image: 'assets/pasta.png' },
    { name: '¼ cup or 1 ounce of nuts (all types)', protein: 7, id: 'nuts', image: 'assets/nuts.png' },
    { name: '1 egg', protein: 6, id: 'egg', image: 'assets/egg.png' }
    ];


function setUnit(unit) {
    const container = document.getElementById('toggleContainer');
    container.className = `toggle-container ${unit}`;
    
    isKg = (unit === 'kg');
    
    weightInput.placeholder = isKg ? "Your weight (kg)" : "Your weight (lbs)";
}

calculateButton.addEventListener('click', function() {
    let weight = parseFloat(weightInput.value);
    if (isNaN(weight) || weight <= 0) {
        results.textContent = "Please enter a valid weight.";
        return;
    }
    let proteinNeeds = isKg ? (weight * 0.8).toFixed(0) : (weight * 0.36).toFixed(0);
    results.textContent = `${proteinNeeds} grams per day`;

    description.textContent = "The Recommended Dietary Allowance (RDA) for protein in adults is 0.36 grams per pound of body weight. People who exercise regularly or are peri/menopausal have higher protein needs.";
    
    document.querySelector('.results-container').style.maxHeight = '500px';
    document.querySelector('.results-container').style.display = 'block';
    document.querySelector('.results-container').style.backgroundColor = '#f5f5f5';
});

activeButton.addEventListener('click', function() {
    let weight = parseFloat(weightInput.value);
    if (isNaN(weight) || weight <= 0) {
        results.textContent = "Please enter a valid weight.";
        return;
    }
    
    let proteinRange = isKg 
    // convert lbs to kg by dividing by 0.4536
        ? `${(weight * (0.5 / 0.4536)).toFixed(0)} - ${(weight * (0.8 / 0.4536)).toFixed(0)}`
        : `${(weight * 0.5).toFixed(0)} - ${(weight * 0.8).toFixed(0)}`;
    results.textContent = `${proteinRange} grams per day`;
    
    description.textContent = "Active individuals need more protein to repair and rebuild muscle tissue damaged during exercise. The recommended intake ranges from 0.5-0.8 grams per pound of body weight.";
    
    document.querySelector('.results-container').style.backgroundColor = '#fff1de';
    document.querySelector('.results-container').style.maxHeight = '500px';
    document.querySelector('.results-container').style.display = 'block';
    
});

periButton.addEventListener('click', function() {
    let weight = parseFloat(weightInput.value);
    if (isNaN(weight) || weight <= 0) {
        results.textContent = "Please enter a valid weight.";
        return;
    }
    
    let proteinRange = isKg 
        ? `${(weight * 1).toFixed(0)} - ${(weight * 1.5).toFixed(0)}`
        : `${(weight * (0.4536 * 1)).toFixed(0)} - ${(weight * (0.4536 * 1.5)).toFixed(0)}`;
    results.textContent = `${proteinRange} grams per day`;

    description.textContent = "During perimenopause and menopause, higher protein intake of 0.54-0.68 grams per pound of body weight helps preserve muscle mass and supports metabolic health.";
    
    document.querySelector('.results-container').style.backgroundColor = '#ffeff2';
    document.querySelector('.results-container').style.maxHeight = '500px';
    document.querySelector('.results-container').style.display = 'block';
});
</script> -->

<script>
    let weightInput = document.getElementById('weightInput');
    let calculateButton = document.getElementById('calculate');
    let results = document.getElementById('results');
    let description = document.getElementById('description');
    let activeButton = document.getElementById('active');
    let periButton = document.getElementById('peri');
    let foodCombinations = document.getElementById('food-combinations');
    let isKg = false;
    let resultsContainer = document.querySelector('.results-container');

    const foods = [
        { name: '3 oz tuna, salmon, haddock, or trout', protein: 21, id: 'fish', image: 'assets/salmon.png' },
        { name: '3 oz cooked turkey or chicken', protein: 19, id: 'poultry', image: 'assets/chicken.png' },
        { name: '6 oz plain Greek yogurt', protein: 17, id: 'yogurt', image: 'assets/yogurt.png' },
        { name: '½ cup cottage cheese', protein: 14, id: 'cottage', image: 'assets/cheese.png' },
        { name: '½ cup cooked beans', protein: 8, id: 'beans', image: 'assets/beans.png' },
        { name: '1 cup of milk', protein: 8, id: 'milk', image: 'assets/milk.png' },
        { name: '1 cup cooked pasta', protein: 8, id: 'pasta', image: 'assets/pasta.png' },
        { name: '¼ cup or 1 ounce of nuts (all types)', protein: 7, id: 'nuts', image: 'assets/nuts.png' },
        { name: '1 egg', protein: 6, id: 'egg', image: 'assets/egg.png' }
    ];

    function generateProteinCombination(targetGrams, tolerance = 5) {
        if (targetGrams < 0) {
            return {
                success: false,
                message: 'Target grams must be positive',
                combination: [],
                totalProtein: 0,
                difference: 0
            };
        }

        const sortedFoods = [...foods].sort((a, b) => b.protein - a.protein);
        let bestCombination = null;
        let bestDifference = Infinity;

        function findCombination(remaining, currentCombo, index) {
            const difference = Math.abs(remaining);
            if (difference <= tolerance) {
                if (difference < bestDifference) {
                    bestDifference = difference;
                    bestCombination = [...currentCombo];
                }
                return;
            }

            if (remaining < 0 && Math.abs(remaining) > bestDifference) {
                return;
            }

            for (let i = index; i < sortedFoods.length; i++) {
                const food = sortedFoods[i];
                const maxQuantity = Math.min(5, Math.ceil(remaining / food.protein) + 1);
                
                for (let qty = 1; qty <= maxQuantity; qty++) {
                    const newRemaining = remaining - (food.protein * qty);
                    
                    const existingIndex = currentCombo.findIndex(item => item.id === food.id);
                    if (existingIndex >= 0) {
                        currentCombo[existingIndex].quantity += qty;
                    } else {
                        currentCombo.push({ ...food, quantity: qty });
                    }

                    findCombination(newRemaining, currentCombo, i + 1);

                    if (existingIndex >= 0) {
                        currentCombo[existingIndex].quantity -= qty;
                        if (currentCombo[existingIndex].quantity === 0) {
                            currentCombo.splice(existingIndex, 1);
                        }
                    } else {
                        currentCombo.pop();
                    }
                }
            }
        }

        findCombination(targetGrams, [], 0);

        if (!bestCombination) {
            return {
                success: false,
                message: `No combination found within ${tolerance}g tolerance`,
                combination: [],
                totalProtein: 0,
                difference: 0
            };
        }

        const totalProtein = bestCombination.reduce(
            (sum, item) => sum + (item.protein * item.quantity), 
            0
        );

        return {
            success: true,
            combination: bestCombination.map(item => ({
                food: item.name,
                quantity: item.quantity,
                proteinPerServing: item.protein,
                totalProtein: item.protein * item.quantity,
                image: item.image
            })),
            totalProtein: totalProtein,
            targetGrams: targetGrams,
            difference: targetGrams - totalProtein
        };
    }

    function displayFoodCombination(targetProtein) {
        const result = generateProteinCombination(targetProtein, 5);
        
        if (!result.success) {
            foodCombinations.innerHTML = `<p style="color: #d32f2f; text-align: center; padding: 20px;">${result.message}</p>`;
            foodCombinations.style.display = 'block';
            return;
        }

        let html = '<div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; padding: 20px 0;">';
        
        result.combination.forEach(item => {
            const quantityBadge = item.quantity > 1 ? `<div style="position: absolute; top: -8px; right: -8px; background: #667eea; color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">×${item.quantity}</div>` : '';
            
            html += `
                <div style="position: relative; background: white; border-radius: 12px; padding: 15px; width: 140px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center; transition: transform 0.2s;">
                    ${quantityBadge}
                    <img src="${item.image}" alt="${item.food}" style="width: 80px; height: 80px; object-fit: contain; margin-bottom: 10px;" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2280%22 height=%2280%22%3E%3Crect fill=%22%23ddd%22 width=%2280%22 height=%2280%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 font-size=%2214%22 text-anchor=%22middle%22 dy=%22.3em%22%3E🍽️%3C/text%3E%3C/svg%3E';">
                    <div style="font-size: 12px; color: #555; margin-bottom: 5px; line-height: 1.3; min-height: 32px;">${item.food}</div>
                    <div style="font-size: 16px; color: #667eea; font-weight: bold;">${item.totalProtein}g</div>
                </div>
            `;
        });
        
        html += '</div>';

        // const diffText = result.difference === 0 
        //     ? '✓ Perfect match!' 
        //     : `Total: ${result.totalProtein}g (${result.difference > 0 ? '+' : ''}${result.difference}g difference)`;
        
        // html += `<div style="text-align: center; padding: 10px; background: ${result.difference === 0 ? '#e8f5e9' : '#f5f5f5'}; border-radius: 8px; color: ${result.difference === 0 ? '#2e7d32' : '#666'}; font-weight: 600;">${diffText}</div>`;
        
        foodCombinations.innerHTML = html;
        foodCombinations.style.display = 'block';
    }

    function setUnit(unit) {
        const container = document.getElementById('toggleContainer');
        container.className = `toggle-container ${unit}`;
        
        isKg = (unit === 'kg');
        
        weightInput.placeholder = isKg ? "Your weight (kg)" : "Your weight (lbs)";
    }

    calculateButton.addEventListener('click', function() {
        let weight = parseFloat(weightInput.value);
        if (isNaN(weight) || weight <= 0) {
            results.textContent = "Please enter a valid weight.";
            foodCombinations.style.display = 'none';
            return;
        }
        let proteinNeeds = isKg ? (weight * 0.8).toFixed(0) : (weight * 0.36).toFixed(0);
        results.textContent = `${proteinNeeds} grams per day`;

        description.textContent = "The Recommended Dietary Allowance (RDA) for protein in adults is 0.36 grams per pound of body weight. People who exercise regularly or are peri/menopausal have higher protein needs.";
        
        displayFoodCombination(parseInt(proteinNeeds));
        
        document.querySelector('.results-container').style.maxHeight = '1000px';
        document.querySelector('.results-container').style.display = 'block';
        document.querySelector('.results-container').style.backgroundColor = '#f5f5f5';
    });

    activeButton.addEventListener('click', function() {
        let weight = parseFloat(weightInput.value);
        if (isNaN(weight) || weight <= 0) {
            results.textContent = "Please enter a valid weight.";
            foodCombinations.style.display = 'none';
            return;
        }
        
        let proteinRange = isKg 
            ? `${(weight * (0.5 / 0.4536)).toFixed(0)} - ${(weight * (0.8 / 0.4536)).toFixed(0)}`
            : `${(weight * 0.5).toFixed(0)} - ${(weight * 0.8).toFixed(0)}`;
        
        // Use the midpoint for food combination
        let midpoint = isKg 
            ? Math.round(weight * (0.65 / 0.4536))
            : Math.round(weight * 0.65);
        
        results.textContent = `${proteinRange} grams per day`;
        
        description.textContent = "Active individuals need more protein to repair and rebuild muscle tissue damaged during exercise. The recommended intake ranges from 0.5-0.8 grams per pound of body weight.";
        
        displayFoodCombination(midpoint);
        
        document.querySelector('.results-container').style.backgroundColor = '#fff1de';
        document.querySelector('.results-container').style.maxHeight = '1000px';
        document.querySelector('.results-container').style.display = 'block';
    });

    periButton.addEventListener('click', function() {
        let weight = parseFloat(weightInput.value);
        if (isNaN(weight) || weight <= 0) {
            results.textContent = "Please enter a valid weight.";
            foodCombinations.style.display = 'none';
            return;
        }
        
        let proteinRange = isKg 
            ? `${(weight * 1).toFixed(0)} - ${(weight * 1.5).toFixed(0)}`
            : `${(weight * (0.4536 * 1)).toFixed(0)} - ${(weight * (0.4536 * 1.5)).toFixed(0)}`;
        
        // Use the midpoint for food combination
        let midpoint = isKg 
            ? Math.round(weight * 1.25)
            : Math.round(weight * 0.4536 * 1.25);

        results.textContent = `${proteinRange} grams per day`;

        description.textContent = "During perimenopause and menopause, higher protein intake of 0.54-0.68 grams per pound of body weight helps preserve muscle mass and supports metabolic health.";
        
        displayFoodCombination(midpoint);
        
        document.querySelector('.results-container').style.backgroundColor = '#ffeff2';
        document.querySelector('.results-container').style.maxHeight = '1000px';
        document.querySelector('.results-container').style.display = 'block';
    });
</script>
</body>
</html>